---
title: 模拟微电子(2)
categories: 电子信息  
tags: 电子信息 
---

# 一 理想运算放大器
<div align=center><img src="/public/image/模拟微电子/理想运算放大器.jpg"/>图1 理想运算放大器</div>
　　理想运算放大器如图1所示，1脚和2脚是输入，4脚是正电压供电，5脚是负电压供电（有的放大器只需要正电压供电即可），3脚是放大器的输出。  
　　理想运算放大器是一个差分放大器，开环增益A无穷大，输入阻抗无穷大，进入到端子1和端子2的电流为零，端子3输出总是为$A(V_2-V_1)$，独立于从端子3进入负载阻抗的电流，也就是说，理想运算放大器的输出阻抗被假定为零。  
　　理想运算放大器的特性总结如下所示：

1. 无限输入阻抗
2. 零输出阻抗
3. 零共模增益或无限共模抑制
4. 无限开环增益A
5. 无限带宽

　　差模输入信号是两个输入信号$V_2$和$V_1$的差值，即
<div><center>
$$ 
V_{Id}=V_2-V_1 \tag{1} 
$$
</center></div>   
　　共模输入信号是两个输入信号$V_2$和$V_1$的平均值，即
<div><center>
$$ 
V_{I_{cm}}=\frac{1}{2}(V_2+V_1)\tag{2} 
$$
</center></div> 
　　我们也可以用差模信号和共模信号表示$V_2$和$V_1$
<div><center>
$$ 
V_1=V_{I_{cm}}-V_{Id}/2\tag{3} 
$$
</center></div> 
<div><center>
$$ 
V_2=V_{I_{cm}}+V_{Id}/2\tag{4} 
$$
</center></div> 
　　用图像表示如下：
<div align=center><img src="/public/image/模拟微电子/信号源用他们的差模和共模成分表示.jpg"/>图2 信号源用他们的差模和共模成分表示</div>

# 二 反相组态
　　运算放大器并不会单独使用，而是用无源器件连接成反馈回路，如果输出反馈到端子1，称引入了负反馈；如果输入反馈到端子2，称引入了了正反馈，引入反馈之后，运算放大器组成了闭环。
<div align=center><img src="/public/image/模拟微电子/反相闭环组态.jpg"/>图3 反相闭环组态</div>
　　虚短：如果两个端子“在电位上相等”，则称这两个端子之间虚短路，不管端子2上的电压是多少，端子1上的电压都会自动同步端子2上的电压，就好像这两个端子之间短路了一样，但请注意他们物理上并没有真的连接在一起。  
　　上图所示的电路，假定运算放大器是理想的，增益A为无穷大，闭环增益为：
<div><center>
$$ 
G=\frac{V_o}{V_i}=-\frac{R_2}{R_1}\tag{5} 
$$
</center></div>
　　其中负号表示闭环放大器将信号反相，即输出信号与输出信号相位相差180°。  
　　理想放大器本身就可以放大信号，为什么还要用闭环增益来放大呢？通过负反馈，只要电阻$R_2/R_1$精度足够，就可以得到一个比A小，但是可预测的、稳定的闭环增益$-R_2/R_1$。  
　　实际中没有运算放大器的增益A真的为无穷大，我们暂时假设A很大，但是一个有限值。以此为前提，按照推导理想运算放大器的方法可以推出闭环增益G为：
<div><center>
$$ 
G=\frac{V_o}{V_i}=-\frac{-R_{2}/R_{1}}{1+(1+R_{2}/R_{1})/A}\tag{6} 
$$
</center></div>
　　当A趋向于无穷大时，G就趋向于理想值$- R_2/R_1$，因此我们看出只有当$1+\frac{R_2}{R_1} \ll A$时,闭环增益G才等于$-R_2/R_1$。  
　　假定理想运算放大器具有无限开环增益，那么该放大器的输入电阻就等于$R_1$，在第一章放大器电路模型中我们谈到过，放大器应该具有尽可能大的输入电阻，尽可能小的输出电阻，在反相运算放大器组态中，如果输入电阻R_1已经很大了，为了保持高增益，那么$R_2$可能大的离谱，以致于工业界根本就不存在这样大的电阻，解决办法如下：
<div align=center><img src="/public/image/模拟微电子/基本反相组态的改进.jpg"/>图4 基本反相组态的改进</div>
　　此时增益为：
<div><center>
$$ 
G=\frac{V_o}{V_i}=-\frac{R_2}{R_1}(1+\frac{R_4}{R_2}+\frac{R_4}{R_3})\tag{7} 
$$
</center></div>
　　尽管$R_1$很大，但是我们让$R_2$等于$R_1$，只要保持括号中的$R_4/R_3$很大，增益依旧很大，而且还保持了高输入阻抗，低输出阻抗，完美😊  
　　反相组态的一个非常重要的应用就是下图所示的加权加法电路，其中$R_f$组成负反馈回路：  
<div align=center><img src="/public/image/模拟微电子/加权加法器.jpg"/>图5 加权加法器</div>
　　可以看出，该电路可以通过调整电阻值来调整加权系数，但是加权系数都是负的，要得到正的加权系数，可以通过两个放大器级联消掉符号得到：

<div align=center><img src="/public/image/模拟微电子/能够实现两种符号的加权加法器.jpg"/>图6 能够实现两种符号的加权加法器</div>

# 三 同相组态
　　第二种闭环组态为同相组态，输入信号$V_I$直接加到运算放大器的同相输入端，而$R_1$另一端直接接地，如下所示：
<div align=center><img src="/public/image/模拟微电子/同相组态.jpg"/>图7 同相组态</div>
　　假定运算放大器是理想的，具有无穷大的增益A，可以推出闭环增益为 
<div><center>
$$ 
G=1+\frac{R_2}{R_1}\tag{8} 
$$
</center></div>
　　现在我们假设运算放大器不是理想的，A很大但不是无穷大，同样的推导方法可以推出
<div><center>
$$ 
G=\frac{V_o}{V_i}=\frac{1+R_2/R_1}{1+\frac{1+R_2/R_1}{A}}\tag{9} 
$$
</center></div>
　　可以看出该分母等于反相组态的情况，因为他们的反馈环相同，但是他们的分子不同，因为分子给出了理想或标称闭环增益，只有当$1+\frac{R_2}{R_1} \ll A$时才有：
<div><center>
$$ 
G=1+\frac{R_2}{R_1}\tag{10} 
$$
</center></div>

# 四 差分放大器
　　用差模成分和共模成分来表示$V_1$和$V_2$在之前已经介绍过，所以我们可以此为基础设计差分放大器和差动放大器，实际电路的输出电压$V_o$可以表示为：
<div><center>
$$ 
V_o=A_dV_{I_d}+A_{cm}V_{I_{cm}}\tag{11} 
$$
</center></div>
　　$A_d$表示放大器的差模增益，$A_{cm}$表示放大器的共模增益，理想的差分放大器应该差模增益远大于共模增益且共模增益尽可能小，我们用共模抑制比（CMRR）来表示放大器的抑制效果，定义如下：
<div><center>
$$ 
CMRR=20Log\frac{|A_d|}{|A_{cm}|}\tag{12} 
$$
</center></div>
　　运算放大器本身就是一个差分放大器，那为什么我们不直接用他呢？因为差分放大器增益可控、稳定。除此之外，我们需要差分放大器放大差分信号的同时，还需要共模抑制，前面的放大器在放大差分信号的同时也放大了共模信号，这是一个非常严重的问题。
<div align=center><img src="/public/image/模拟微电子/差分放大器.jpg"/>图8 差分放大器</div>
　　上图所示的差分放大器，只要保持：
<div><center>
$$ 
\frac{R_4}{R_3}=\frac{R_2}{R_1}\tag{13} 
$$
</center></div>
　　就可以放大差分信号，抑制共模信号。但是如果要有大的差模增益$R_2/R_1$，那么$R_1$就必须较小，输入电阻就必须较小，对于输入电阻较小这个问题，可以加一个[电压跟随器](https://zhuanlan.zhihu.com/p/208986728)。  
　　下面是一个非常好的仪表放大电路，他在仪表放大电路中被广泛使用。


<div align=center><img src="/public/image/模拟微电子/仪表放大电路.jpg"/>图9 仪表放大电路</div>
　　当输入差模信号，分析结果如图所示，当输入共模信号，第一级并不放大共模信号，它只是把共模信号传播到它的两个输出端，然后二者相减并由$A_3$实现零共模输出。因此总的来说，该电路放大了差分信号，抑制了共模信号，并且共模信号可以通过只改变$2R_1$电阻来实现，这是一个非常好的差分放大电路，并在仪表放大器中被广泛使用。

# 五 有限开环增益与带宽对电路性能的影响
　　前面我们假设理想运算放大器的特性是理想的，增益不随频率变化，但实际上一个运算放大器的差模开环增益是有限的，而且它随着频率的增大而减小，如下图所示：
<div align=center><img src="/public/image/模拟微电子/一个具有内部补偿的通用运算放大器的开环增益.jpg"/>图10 一个具有内部补偿的通用运算放大器的开环增益</div>
　　尽管该增益在直流和低频处很高，但是增益从相当低的频率就开始下降了（图中是10Hz），改善开环增益的过程称为频率补偿，它的目的是确保运算放大器电路稳定。  
　　一个具有内部补偿的运算放大器的增益A(s)可以表示为：
<div><center>
$$ 
A(s)=\frac{A_0}{1+s/ \omega_b}\tag{14} 
$$
</center></div>
　　对于物理频率，s=j，上式则变为
<div><center>
$$ 
A(s)=\frac{A_0}{1+j\omega/ \omega_b}\tag{15} 
$$
</center></div>
　　其中，$A_0$表示直流增益，$\omega_b$是3dB频率，当频率$\omega \gg \omega_b$时（大于10倍或更多），上式可以近似为：
<div><center>
$$ 
A(j\omega)=\frac{A_0 \omega_b}{\omega}\tag{16} 
$$
</center></div>
　　令增益|A|在达到单位增益（0dB）时的频率为$\omega_t$，则
<div><center>
$$ 
\omega_t=A_0 \omega_b \tag{17} 
$$
</center></div>
　　从而当频率$\omega \gg \omega_b$时，式（15）的开环增益变为
<div><center>
$$ 
A(j\omega) \approx \frac{\omega_t}{\omega}=\frac{f_t}{f} \tag{18} 
$$
</center></div>
　　从上式可以看到，在满足频率远大于3dB频率的条件下，可以很容易地确定运算放大器增益在给定频率$f$处的幅度。  
　　同一类型的运算放大器单元之间的$f_t$的制造差值要远小于$A_0$和$f_b$的制造差值，因此，把$f_t$作为指标参数更方便，这个参数也称为增益带宽积。  
　　在本章的第二节、第三节反相/同相组态，我们推导闭环增益的前提都是开环增益A不变，但是这一节我们已经知道放大器的闭环增益是频率的函数。以此为前提，可以推出反相放大器的增益
<div><center>
$$ 
\frac{V_o}{V_i}=\frac{-R_2/R_1}{1+\frac{1}{A_0}(1+\frac{R_2}{R_1})+\frac{s}{\omega_t/(1+R_2/R_1)}}\tag{19} 
$$
</center></div>
　　反相放大器具有STC低通响应，其直流增益幅度为$R_2/R_1$，闭环增益以-20dB/十倍频程的斜率下降，其3dB频率为
<div><center>
$$ 
\omega_{3dB} =\frac{\omega_t}{1+R_2/R_1} \tag{20} 
$$
</center></div>
　　同理，也可得到同相放大器的闭环传输函数，它也具有STC低通响应，其直流增益幅度为$（1+R_2/R_1）$，3dB频率同式（20）

# 六 运算放大器的的大信号工作性能
运算放大器在输出大信号时会有4个限制。
1. 输出电压饱和：运算放大器在有限的输出电压范围内工作在线性状态，超过饱和电压将不再放大信号，或者超出线性区域放大倍数不再是线性。
2. 输出电流限制：运算放大器的输出电流有一个指定的最大值，例如741运放的最大输出电流为$\pm 20mA$,所以反馈电流和负载电流不能超过这个值。
3. 摆率：运放的输出端有一个特定的最大变化率，称为运放的摆率，如果加入到运放的输入信号使得其输出响应要求快于指定的SR值，那么运放的输出只以最大可能的速率变化，该变化率等于它的SR值。
4. 全功率带宽$f_M$：由于摆率的限制，幅度等于运算放大器额定输出电压的输出正弦波从该频率开始出现失真，设额定输出电压记为$V_{omax}$，那么
<div><center>
$$ 
\omega_{M} V_{omax} =SR \tag{21} 
$$
</center></div>

# 七 直流不完整性
　　运算放大器是直接耦合器件，在直流时具有较大的增益，因此容易产生直流问题，第一个问题是直流失调电压，第二个问题是输入偏置电流。
## 1 失调电压
　　因为运算放大器内部输入差分级不匹配，会产生输入失调电压$V_{OS}$，也就是说，即使把运算放大器的两个输入端连接在一起并且接地，它的输出端仍然有一个直流电压，等效模型如下所示：
<div align=center><img src="/public/image/模拟微电子/有输入失调电压的运算放大器的电路模型.jpg"/>图11 有输入失调电压的运算放大器的电路模型</div>
　　通用的运算放大器的$V_{OS}$在1mV-5mV的范围内，具体的值与温度有关，它是温度的函数，因为产生$V_{OS}$的元件不匹配事先不可能被明确知道，所以$V_{OS}$的极性厂商也不可能事先知道。    
　　如果不需要放大直流和低频信号，一种解决直流失调的方法是采用电容耦合放大器，如下图所示。
<div align=center><img src="/public/image/模拟微电子/电容耦合反相放大器及其直流等效模型.jpg"/>图12 电容耦合反相放大器及其直流等效模型</div>
　　在直流或者低频时，电容的阻抗为无穷，左边（a）所示的电路相当于图（b）所示的一个单位增益电压跟随器，失调电压$V_{OS}$产生的输出V_o就等于$V_{OS}$，不会放大失调电压，虽说没有抑制失调电压，但失调电压都很小，一般只有1mV-5mV；当输入交流信号，耦合电容$C$与$R_1$共同组成一个STC高通电路，它的角频率为$\omega_0=1/CR_1$。电容耦合放大器的的增益从高频时的$（1+R_2/R_1）$开始下降，并且在$\omega_0$处下降3dB。

## 2 输入偏置与失调电流
　　运算放大器的第二个直流问题如下图所示，为了使运算放大器能够工作，它的两个输入端必须用直流电流供电，称为输入偏置电流，这两个电流分别用电流源$I_{B_1}$和$I_{B_2}$表示，他们分别连接到两个输入端。
<div align=center><img src="/public/image/模拟微电子/运算放大器的输入偏置电流.jpg"/>图13 运算放大器的输入偏置电流</div>
　　制造商通常会指明$I_{B_1}$和$I_{B_2}$的平均值及其期望的差值，平均值$I_B$称为输入偏置电流：
<div><center>
$$ 
I_B=\frac{I_{B1}+I_{B2}}{2} \tag{22} 
$$
</center></div>
　　差值称为输入失调电流：
<div><center>
$$ 
I_{os}= \lvert I_{B1}-I_{B2} \rvert\tag{23} 
$$
</center></div>
　　对于双极性晶体管的通用运算放大器的典型值$I_B$=100nA，$I_{OS}$=10nA,对于场效应管的运算放大器输入偏置电流会更小，为pA数量级。  
　　考虑了输入偏置电流后，由于输入偏置电流产生的闭环放大器的直流输出电压为
<div><center>
$$ 
V_o=I_{B1}R_2 \approx I_BR_2\tag{24} 
$$
</center></div>

<div align=center><img src="/public/image/模拟微电子/考虑了输入偏置电流后对闭环放大器的分析.jpg"/>图14 考虑了输入偏置电流后对闭环放大器的分析</div>
　　为了减小由于输入偏置电流产生的直流输出电压值，可以在同相输入端串联一个电阻$R_3$
<div align=center><img src="/public/image/模拟微电子/引入电阻R3减小输入偏置电流的影响.jpg"/>图15 引入电阻R3减小输入偏置电流的影响</div>
　　此时失调电流$I_{OS}$产生的直流输出电压为:
<div><center>
$$ 
V_o=I_{os}R_2 \tag{25} 
$$
</center></div>
　　该结果虽然没有把失调电流的影响降低为零，但是该结果通常比没有$R_3$时得到的值小一个数量级左右，综上，为了使输入偏置电流的影响最小，应该在同相输入端放一个电阻，该电阻等于从反相端看进去的等效直流电阻，如果放大器是交流耦合的，那么应该选择$R_3$等于$R_2$。
<div align=center><img src="/public/image/模拟微电子/放大器是交流耦合的.jpg"/>图16 放大器是交流耦合的</div>

# 八 积分器与微分器
## 1 具有通用阻抗的反相组态
<div align=center><img src="/public/image/在反馈和输入回路中具有通用阻抗的反相组态放大器.jpg"/>图17 在反馈和输入回路中具有通用阻抗的反相组态放大器</div>
　　用阻抗$Z_1$和$Z_2$替代电阻$R_1$和$R_2$，就可以得到更通用的闭环增益，或者说该电路的传输函数：
<div><center>
$$ 
\frac{V_o(s)}{V_i(s)}=-\frac{Z_2(s)}{Z_1(s)} \tag{26} 
$$
</center></div>

## 2 反相积分器
　　如下图所示的电路，在反馈支路上用一个电容替换$Z_2$,那么输出电压是一个随时间变化的积分电路，又称米勒积分器
<div align=center><img src="/public/image/反相积分器.jpg"/>图18 反相积分器</div>
　　传输函数：
<div><center>
$$ 
\frac{V_o(s)}{V_i(s)}=-\frac{1}{sCR}} \tag{27} 
$$
</center></div>
　　相位：
<div><center>
$$ 
\varphi=+90° \tag{28} 
$$
</center></div>
　　其中$\omega_int=1/CR$被称为积分频率，分析输出电压$V_o$的表达式我们可以知道，运算放大器的失调电压和电流会在输出端不断积分，引起输出饱和，因为反馈元件是电容，所以在直流工作时电容因为开路而使得电路中没有负反馈，即输入信号中任何微小的直流分量在理论上都会产生一个无限的输出。
<div align=center><img src="/public/image/米勒积分器电容两端并联电阻.jpg"/>图19 米勒积分器电容两端并联电阻</div>
　　在电容两端并联一个电阻$R_F$可以解决这个问题，但是会影响积分器极点的频率从它的理想位置$\omega=0$处偏移。

## 3 运算放大器微分器
　　交换积分器中电阻和电容的位置，得到如下所示的微分电路：
<div align=center><img src="/public/image/运算放大器微分器.jpg"/>图20 运算放大器微分器</div>
　　运算放大器输出端的电压为
<div><center>
$$ 
V_o(t)=-CR \frac{dv_I(t)}{dt} \tag{29} 
$$
</center></div>
　　相位：
<div><center>
$$ 
\varphi=-90° \tag{30} 
$$
　　微分器的频率响应可以认为时STC高通滤波器的频率响应，并且角频率为无穷大，微分电路的本质使得它成为一个噪声放大器，因为输入的每一次剧变都会在输出端产生一个尖峰信号，所以实际中要避免使用这种微分电路，类似的，我们可以在电容串联一个小电阻解决这个问题，但是这样又会使得该电路变为非理想的微分器。





























